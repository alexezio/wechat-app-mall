<!-- pages/login/index-new.wxml -->
<view class="login-container">
  
  <!-- Logo区域 -->
  <view class="logo-section">
    <view class="logo-placeholder">🌿</view>
    <text class="app-name">生鲜商城</text>
    <text class="slogan">新鲜好货，实惠到家</text>
  </view>

  <!-- 步骤1: 获取手机号 -->
  <view class="step-section" wx:if="{{step === 1}}">
    <view class="step-title">欢迎使用</view>
    <view class="step-desc">为了给您提供更好的服务，请先授权手机号</view>
    
    <!-- 隐私政策勾选 -->
    <view class="protocol-section">
      <view class="protocol-checkbox" bindtap="toggleAgreeProtocol">
        <view class="checkbox {{agreeProtocol ? 'checked' : ''}}">
          <van-icon wx:if="{{agreeProtocol}}" name="success" size="14" color="#fff" />
        </view>
        <view class="protocol-text">
          <text>我已阅读并同意</text>
          <text class="protocol-link" catchtap="viewUserAgreement">《用户协议》</text>
          <text>和</text>
          <text class="protocol-link" catchtap="viewPrivacyPolicy">《隐私政策》</text>
        </view>
      </view>
    </view>
    
    <button 
      class="auth-button {{agreeProtocol ? '' : 'disabled'}}" 
      open-type="getPhoneNumber"
      bindgetphonenumber="getPhoneNumber"
      loading="{{loading}}"
      disabled="{{loading || !agreeProtocol}}"
    >
      <van-icon name="phone-o" size="20" />
      <text>授权手机号</text>
    </button>
    
    <view class="tips">
      <van-icon name="info-o" size="14" />
      <text>我们承诺保护您的隐私信息</text>
    </view>
  </view>

  <!-- 步骤2: 完善信息 -->
  <view class="step-section" wx:if="{{step === 2}}">
    <view class="step-title">完善信息</view>
    <view class="step-desc">手机号已获取: {{phoneNumber}}</view>
    
    <view class="form-item">
      <view class="label">昵称（选填）</view>
      <input 
        class="input" 
        placeholder="请输入昵称" 
        value="{{nick}}"
        bindinput="onNickInput"
        maxlength="20"
      />
    </view>
    
    <button 
      class="submit-button" 
      bindtap="register"
      loading="{{loading}}"
      disabled="{{loading}}"
    >
      完成注册
    </button>
    
    <view class="skip-link" bindtap="skipRegister">
      暂时跳过 >
    </view>
  </view>

  
</view>
