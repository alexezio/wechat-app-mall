<!-- pages/farm/trace-detail.wxml -->
<view class="trace-container">
  
  <!-- 顶部产品信息 -->
  <view class="product-card">
    <view class="product-header">
      <van-icon name="passed" color="#07c160" size="60rpx" />
      <text class="verify-text">溯源验证通过</text>
    </view>
    <view class="product-info">
      <view class="info-row">
        <text class="label">产品名称</text>
        <text class="value">{{traceInfo.productName}}</text>
      </view>
      <view class="info-row">
        <text class="label">溯源码</text>
        <text class="value code">{{traceInfo.traceCode}}</text>
      </view>
      <view class="info-row">
        <text class="label">批次号</text>
        <text class="value">{{traceInfo.batchNo}}</text>
      </view>
      <view class="info-row">
        <text class="label">养殖周期</text>
        <text class="value">{{traceInfo.breedingDays}}天</text>
      </view>
      <view class="info-row">
        <text class="label">出栏日期</text>
        <text class="value">{{traceInfo.outDate}}</text>
      </view>
      <view class="info-row">
        <text class="label">产品重量</text>
        <text class="value">{{traceInfo.weight}}</text>
      </view>
    </view>
  </view>

  <!-- 农庄信息 -->
  <view class="farm-card">
    <view class="card-title">
      <van-icon name="shop-o" />
      <text>养殖农庄</text>
    </view>
    <view class="farm-info">
      <view class="info-row">
        <text class="label">农庄名称</text>
        <text class="value">{{traceInfo.farmInfo.name}}</text>
      </view>
      <view class="info-row">
        <text class="label">农庄地址</text>
        <text class="value">{{traceInfo.farmInfo.address}}</text>
      </view>
      <view class="info-row">
        <text class="label">经营许可</text>
        <text class="value">{{traceInfo.farmInfo.license}}</text>
      </view>
    </view>
  </view>

  <!-- 养殖时间线 -->
  <view class="timeline-card">
    <view class="card-title">
      <van-icon name="clock-o" />
      <text>养殖全程</text>
    </view>
    <view class="timeline">
      <view class="timeline-item" wx:for="{{traceInfo.timeline}}" wx:key="date">
        <view class="timeline-dot"></view>
        <view class="timeline-line" wx:if="{{index < traceInfo.timeline.length - 1}}"></view>
        <view class="timeline-content">
          <view class="timeline-date">{{item.date}}</view>
          <view class="timeline-stage">{{item.stage}}</view>
          <view class="timeline-desc">{{item.description}}</view>
          <view class="timeline-images" wx:if="{{item.images && item.images.length > 0}}">
            <image 
              wx:for="{{item.images}}" 
              wx:for-item="img"
              wx:key="*this"
              class="timeline-image" 
              src="{{img}}" 
              mode="aspectFill"
              bindtap="previewImage"
              data-urls="{{item.images}}"
              data-current="{{img}}"
            />
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 质量报告 -->
  <view class="report-card">
    <view class="card-title">
      <van-icon name="certificate" />
      <text>质量检测</text>
    </view>
    <view class="report-list">
      <view class="report-item" wx:for="{{traceInfo.qualityReports}}" wx:key="reportName">
        <view class="report-info">
          <text class="report-name">{{item.reportName}}</text>
          <view class="report-badge {{item.status}}">
            <text>{{item.status === 'pass' ? '已通过' : '检测中'}}</text>
          </view>
        </view>
        <van-icon 
          name="arrow" 
          wx:if="{{item.reportUrl}}"
          bindtap="viewReport"
          data-url="{{item.reportUrl}}"
        />
      </view>
    </view>
  </view>

  <!-- 认证资质 -->
  <view class="cert-card">
    <view class="card-title">
      <van-icon name="medal-o" />
      <text>认证资质</text>
    </view>
    <view class="cert-list">
      <view class="cert-item" wx:for="{{traceInfo.certifications}}" wx:key="certNo">
        <van-icon name="success" color="#07c160" />
        <view class="cert-info">
          <text class="cert-name">{{item.certName}}</text>
          <text class="cert-no">证书编号：{{item.certNo}}</text>
        </view>
      </view>
    </view>
  </view>

</view>

